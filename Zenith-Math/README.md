Some additional features have been implemented such as caching so that we can avoid recomputing expensive math functions where possible.